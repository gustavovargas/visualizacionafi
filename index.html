<!DOCTYPE html>
<html>
  <head>
    <title>Visualización AFI</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="shortcut icon" type="image/x-icon"  href="https://raw.githubusercontent.com/gustavovargas/visualizacionafi/master/images/logoAFI.ico">

	<script type="text/javascript" src="https://d3js.org/d3.v5.js"></script>
<!--   <script type="text/javascript" src="js/d3/d3.min.js"></script>
 -->  </head>

  <style>
  body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif;}
  body, html {
    height: 100%;
    color: #777;
    line-height: 1.8;
  }
  a {text-decoration: none;}

   /*Efector Parallax */
  .bgimg-1, .bgimg-2, .bgimg-3 {
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
  }

  /* Primera imagen / PORTADA      OJO difuminar más con photoshop antes de enviarlo*/
  .bgimg-1 {
    background-image: url('images/portada.png');
    min-height: 100%;
  }

  /* Segunda imagen */
  .bgimg-2 {
    background-image: url("images/niños.jpg");
    min-height: 400px;
  }

  /* Tercera imagen */
  .bgimg-3 {
    background-image: url("images/soldiers.jpg");
    min-height: 400px;
  }

  .w3-wide {letter-spacing: 10px;}
  .w3-hover-opacity {cursor: pointer;}

  /* quitamos el efector parallax en móviles y tablets */
  @media only screen and (max-device-width: 1600px) {
    .bgimg-1, .bgimg-2, .bgimg-3 {
      background-attachment: scroll;
      min-height: 400px;
    }
  }

  /*Estilo para el tooltip*/
  #tooltip{
      padding: .5em;
      position: absolute;
      display: none;
      background-color: white; 
      opacity: 0.9; 
      text-shadow: #f5f5f5 0 1px 0;
      border-radius: 2px; 
      box-shadow: 0px 0px 2px 0px #a6a6a6;

  }
  </style>
  <body>

  <!-- https://www.w3schools.com/w3css/tryw3css_templates_parallax.htm#portfolio-->

  <!-- BARRA DEL NAVEGADOR DE ARRIBA -->
  <div class="w3-top">
    <div class="w3-bar" id="myNavbar">
      <a class="w3-bar-item w3-button w3-hover-black w3-hide-medium w3-hide-large w3-right" href="javascript:void(0);" onclick="toggleFunction()" title="Toggle Navigation Menu">
        <i class="fa fa-bars"></i>
      </a>
      <a href="#inicio" class="w3-bar-item w3-button">INICIO</a>
      <a href="#historia" class="w3-bar-item w3-button w3-hide-small">HISTORIA</a>
      <a href="#conclusiones" class="w3-bar-item w3-button w3-hide-small">CONCLUSIONES</a>
      <a href="#bibliografia" class="w3-bar-item w3-button w3-hide-small">BIBLIOGRAFÍA</a>
      <a href="#autor" class="w3-bar-item w3-button w3-hide-small">AUTOR</a>
      <a href="http://www.afiescueladefinanzas.es" class="w3-bar-item w3-button w3-hide-small w3-right w3-hover-red"><b>AFI Escuela de Finanzas</b></a>
      </a>
    </div>

    <!-- Barra del navegador en ventanas pequeñas -->
    <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium">
      <a href="#historia" class="w3-bar-item w3-button" onclick="toggleFunction()">HISTORIA</a>
      <a href="#conclusiones" class="w3-bar-item w3-button" onclick="toggleFunction()">CONCLUSIONES</a>
      <a href="#autor" class="w3-bar-item w3-button" onclick="toggleFunction()">AUTOR</a>
    </div>
  </div>

  <!-- CABECERO -->
  <div class="bgimg-1 w3-display-container w3-opacity-min" id="inicio" align="center">
    <div class="w3-display-middle" style="white-space:nowrap;"> <span class="w3-center w3-padding-large w3-wide w3-xxlarge w3-animate-opacity">práctica de datos abiertos y visualización </span> <br>
      <span class="w3-center w3-padding-large w3-black w3-xlarge w3-wide w3-animate-opacity">
      <span class="w3-hide-small">ANARQUÍA EN</span>   SOMALIA</span>
    </div>
  </div>


  <!-- CONTAINER DE Breve historia de Somalia -->
  <div class="w3-content w3-container w3-padding-64" id="historia">
    <h3 class="w3-center">BREVE HISTORIA DE SOMALIA</h3>
    <p class="w3-center"><em>Somalia estuvo sin gobierno desde la caída del dictador Siad Barre el 26 de Enero de 1991 hasta la entrada de la ONU en 2015. ¿Qué consecuencias podemos extraer de 20 años de inestabilidad?</em></p>
    <p>Después de la caída de Barre, los 90 se caracterizaron por continuas disputas entre los Señores de la Guerra y milicias de diferentes clanes. Esto llevo a un hambre generalizado, y la ONU y EEUU intervinieron antes de que fuese a peor. En 2006 la <a href="https://es.wikipedia.org/wiki/Uni%C3%B3n_de_Tribunales_Isl%C3%A1micos" target="_blank">Unión de Tribunales Islámicos</a>  tomó el control de la capital, Mogadishu.
    Entonces Etiopía, país vecino, decidió invadir el país para anular a los islamistas, con el apoyo de EEUU, pero nunca llegó a tomar el control total, reproduciéndose una y otra vez continuas batallas en las calles. Más de un millón y medio de personas del sur del país, especialmente de zonas cercanas a la capital, huyeron como refugiados a otros países <b>[poner gráfico de refugiados en otros países Fuente: UNHCR 2009</b>.
     </p>
  </div>
  
  <div id="tooltip">Tooltip</div>

  <!-- MAPA SOMALIA -->
  <div class="w3-center w3-padding-large">
  	<svg id="container" width="400px" height="400px", style="border: solid 1px black">
      <g id="mapasomalia" style="transform:translate(-1170px,160px)">
      
      </g>
  	</svg>
    <p><b><i class="fa fa-user w3-margin-right"></i>Principales ciudades de Somalia</b></p><br>
  </div>

  <!-- Hide this text on small devices -->
  <div class="w3-content">
    <p>El norte, en cambio, ha tenido una relativa paz, especialmente la zona que antes era británica, Somaliland. Aunque su independencia no es internacionalmente reconocida, en 2010 tuvieron sus primeras elecciones y transferencia pacífica de poder, algo raro en África. Al lado de Somalia tenemos la provincia de Puntland, que si bien no quiere la independencia, está tomada por piratas, que han sido conocidos por secuestrar y extorsionar barcos que pasaban a oriente medio.</p>
    
    <p>A pesar de todo esto, y aunque parezca increíble, el nivel de vida ha ido aumentando lentamente. Es verdad que Somalia sigue siendo uno de los países más pobres de África, pero su población se las ha ingeniado para sobrevivir sin un Estado. El PIB de Somalia y la esperanza de vida han crecido de manera sostenida en estos últimos veinte años, y su gente supo frenar el avance de epidemias como el sida, cosa que países vecinos, con sus Estados, no supieron hacer frente. Esta mejora, en parte, también se debe a las ayudas prestadas por agencias internacionales. <b>[añadir gráfico de ayudas de comida Fueten WFP 2009]</b></p>

    <h4>Piratas</h4>
    <p>Sin nadie que aplique la ley, y con escasas opciones de vida, muchos jóvenes somalíes han decidido volverse piradas, ganando varios millones de dólare por cada barco secuestrado. Distintos países y entidades internacionales han enviado barcos patrulla para evitar dichos asaltos, pero los piratas somalíes han respondido ampliando sus fuerzas y su territorio a saquear, asaltando barcos más cerca de India que del cuerno de África <b>[poner gráfico sobre asaltos Fuente IMB]</b></p>
    </div>
  </div>


    <!-- linechart -->
  <div class="w3-center w3-padding-large">
    <svg id="svg2" height="350" width="600", style="border: solid 1px black">
      <g id="linechart1" style="transform:translate(80px,60px)"></g>
    </svg>
    <p><b><i class="fa fa-user w3-margin-right"></i>Principales ciudades de Somalia</b></p><br>
  </div>



  <!-- BARRA HORIZONTAL con números dentro -->
  <div class="w3-row w3-center w3-dark-grey w3-padding-16">
    <div class="w3-quarter w3-section">
      <span class="w3-xlarge">+20</span><br>
      años en anarquía
    </div>
    <div class="w3-quarter w3-section">
      <span class="w3-xlarge">55+</span><br>
      Projects Done
    </div>
    <div class="w3-quarter w3-section">
      <span class="w3-xlarge">89+</span><br>
      Happy Clients
    </div>
    <div class="w3-quarter w3-section">
      <span class="w3-xlarge">150+</span><br>
      Meetings
    </div>
  </div>

  <!-- Imagen de los niños con Conclusiones encima -->
  <div class="bgimg-2 w3-display-container w3-opacity-min">
    <div class="w3-display-middle">
      <span class="w3-xxlarge w3-text-white w3-wide">CONCLUSIONES</span>
    </div>
  </div>

  <!-- CONTAINER DE CONCLUSIONES -->
  <div class="w3-content w3-container w3-padding-64" id="conclusiones">
    <h3 class="w3-center">¿FUE BUENA LA ANARQUÍA?</h3>
    <p class="w3-center"><em>Con estos ocho indicadores intentaremos entender cómo evolucióno la vida en esta zona del cuerno de África.<br> Haz click en ellos para ampliarlos </em></p><br>

    <!-- Responsive Grid. Four columns on tablets, laptops and desktops. Will stack on mobile devices/small screens (100% width) -->
    <div class="w3-row-padding w3-center">
      <div class="w3-col m3">
        <img src="images/fertilidad.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Fertilidad">
      </div>

      <div class="w3-col m3">
        <img src="images/fertilidad_adolescentes.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Fertilidad en adolescentes">
      </div>

      <div class="w3-col m3">
        <img src="images/mortalidad.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Mortalidad">
      </div>

      <div class="w3-col m3">
        <img src="images/sida.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Número de seropositivos">
      </div>
    </div>

    <div class="w3-row-padding w3-center w3-section">
      <div class="w3-col m3">
        <img src="images/forest.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Áres forestal" >
      </div>

      <div class="w3-col m3">
        <img src="images/moviles.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Número de abonados a servicios de telefonía móvil">
      </div>

      <div class="w3-col m3">
        <img src="images/inversion.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Inversión extranjera directa">
      </div>

      <div class="w3-col m3">
        <img src="images/ayuda.png" style="width:100%" onclick="onClick(this)" class="w3-hover-opacity" alt="Cantidad de ayuda externa">
      </div>

    </div>
  </div>

  <!-- Estilo que sale cuando clickas una foto de las de arriba-->
  <div id="modal01" class="w3-modal w3-black" onclick="this.style.display='none'">
    <span class="w3-button w3-large w3-black w3-display-topright" title="Close Modal Image"><i class="fa fa-remove"></i></span>
    <div class="w3-modal-content w3-animate-zoom w3-center w3-transparent w3-padding-64">
      <img id="img01" class="w3-image">
      <p id="caption" class="w3-opacity w3-large"></p>
    </div>
    <!-- <p>Aquí podría poner un texto si fuese necesario</p> -->
  </div>

  <!-- CONTAINER DE BIBLIOGRAFÍA -->
  <div class="w3-content w3-container w3-padding-64" id="bibliografia">
    <h3 class="w3-center">BIBLIOGRAFÍA</h3>
      <p class="w3-content"><i class="fa fa-newspaper-o"></i> <a href="https://www.bbc.com/news/world-africa-12285365" target="_blank"">Editorial (2011). Somalia: Counting the cost of anarchy. <i>BBC News</i>.</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=1676428#" target="_blank"">Farley, Benjamin R. (2010). Calling a State a State:Somaliland and International Recognition. <i>Emory International Law Review</i>, Vol. 24, No. 2.</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=1801563" target="_blank"">Luther, W. & White, L. Positively Valued Fiat Money after the Sovereign Disappears: The Case of Somalia. <i>GMU Working Paper in Economics</i> No. 11-14</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="http://documents.worldbank.org/curated/en/975231536256355812/pdf/REPLACEMENT-PUBLIC-Somalia-Economic-Update-3-FINAL.pdf" target="_blank"">World Bank Document (August 2018). Somalia Economic Update.</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://landinfo.no/wp-content/uploads/2018/06/Report-Somalia-Security-challenges-in-Mogadishu-May-2018-1.pdf" target="_blank"">Landinfo (May 2018). Somalia: Security challenges in Mogadishu.</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://www.belfercenter.org/sites/default/files/legacy/files/is3103_pp074-106_menkhaus.pdf" target="_blank"">Menkhaus, K. (2006) Governance without Government in Somalia. <i>International Security</i>, Vol. 31, No. 3, pp. 74-106</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://www.orfonline.org/research/somalia-a-failed-state/" target="_blank"">Venugopalan, H. (February 2017). Somalia: A failed state?. <i>ORF Issue Brief</i>. Issue No. 170</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://www.orfonline.org/research/somalia-a-failed-state/" target="_blank"">Powell, B. (2008). Somalia after State Collapse: chaos or improvement?. <i>Journal of economic behaviour & organization</i>. No. 67, pp 657–670</a></p>

      <p class="w3-content"><i class="fa fa-book"></i> <a href="https://www.orfonline.org/research/somalia-a-failed-state/" target="_blank"">Coyne, C. & Leeson, P. (2010). Somalia: Understanding feasible institutions. En <i>Somalia: Economic, Political and Social Issues</i> (Nova Publishers), Elias P. Hoffmann ed., pp. 61-67.</a></p>
    
  </div>

  <!-- Tercer Parallax antes del autor -->
  <div class="bgimg-3 w3-display-container w3-opacity-min">
    <div class="w3-display-middle">
       <span class="w3-xxlarge w3-text-white w3-wide">AUTOR</span>
    </div>
  </div>

  <!-- Container del autor -->
  <div class="w3-content w3-container w3-padding-64" id="autor">
    <h3 class="w3-center">GUSTAVO VARGAS</h3>
    <p class="w3-center"><em>Estudiante del máster en Data Science y Big Data Finanzas de AFI <br>Práctica de visualización y datos abiertos</em></p>
    <div class="w3-row w3-section">
      <div class="w3-col m4 w3-container w3-hover-opacity w3-animate-opacity">
        <img src="images/careto.png" class="w3-image w3-round" style="width:100%">
      </div>
      <div class="w3-col m8 w3-panel">
        <div class="w3-large w3-margin-bottom">
          <i class="fa fa-map-marker fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Madrid, ES<br>
          <i class="fa fa-phone fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Teléfono: +34 633 316 474<br>
          <i class="fa fa-envelope fa-fw w3-hover-text-black w3-xlarge w3-margin-right"></i> Email: ge.vargasn@gmail.com<br>
        </div>
      </div>
    </div>
  </div>

  <!-- Pié de página -->
  <footer class="w3-center w3-black w3-padding-64 w3-opacity w3-hover-opacity-off">
    <a href="#inicio" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>Volver al inicio</a>
    <div class="w3-xlarge w3-section">
      <a href="https://www.facebook.com/ge.vargasn" class="fa fa-facebook-official w3-hover-opacity" target="_blank"></a>
      <a href="https://www.instagram.com/gvarnu/" class="fa fa-instagram w3-hover-opacity" target="_blank"></a>
      <a href= "https://twitter.com/gvarnu" class="fa fa-twitter w3-hover-opacity" target="_blank"></a>
      <a href="https://www.linkedin.com/in/gustavovargas2/" class="fa fa-linkedin w3-hover-opacity" target="_blank"></a>
    </div>
    <p>Plantilla base de <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
  </footer>
   
  <script>
  // Función que hace que se abran las imágenes con fondo negro
  function onClick(element) {
    document.getElementById("img01").src = element.src;
    document.getElementById("modal01").style.display = "block";
    var captionText = document.getElementById("caption");
    captionText.innerHTML = element.alt;
  }

  // Función que hace que cambie el fondo de la barra de navegación del cabecero
  window.onscroll = function() {myFunction()};
  function myFunction() {
      var navbar = document.getElementById("myNavbar");
      if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
          navbar.className = "w3-bar" + " w3-card" + " w3-animate-top" + " w3-white";
      } else {
          navbar.className = navbar.className.replace(" w3-card w3-animate-top w3-white", "");
      }
  }

  // Es la función que hace que la barra de navegación del cabecero que sale en ventanas pequeñas. No hace bien lo del responsive MEJORAR
  function toggleFunction() {
      var x = document.getElementById("navDemo");
      if (x.className.indexOf("w3-show") == -1) {
          x.className += " w3-show";
      } else {
          x.className = x.className.replace(" w3-show", "");
      }
  }
  </script>


 <script type="text/javascript">
	let mapa = d3.select("#mapasomalia")
	d3.json("json/somalia4.geojson").then(showData)

  function showTooltip(text,coords){  // función para el tooltip
    d3.select("#tooltip").text(text)
      .style("top",coords[1]+"px")
      .style("left",coords[0]+10+"px")
      .style("display","block")
  }

	function showData(mapInfo){
		let bodyHeight = 350
		let bodyWidth = 350

		let projection = d3.geoMercator()  // probar geoNaturalEarth1() por si queda mejor
			.scale(1500)
			.translate([bodyWidth/2,bodyHeight/2])

		let path = d3.geoPath()
			.projection(projection)

		mapa.selectAll("path")
			.data(mapInfo.features)
			.enter()
			.append("path")
			.attr("d",d=>path(d))
			.attr("stroke","#999")
			.attr("fill","#eee")
      .on("mouseenter",function(){  // para que se coloree cada feature del d3
        this.style.fill = "#989898"
      })
      .on("mouseout",function(){
        this.style.fill="#eee"
      })
      .on("mousemove", d=>{
        showTooltip(d.id, [d3.event.pageX, d3.event.pageY]) // tiene que ser event.page, porque con event.client no reconoce bien las coordenadas, porque las del svg y body no son las mismas
      })
      .on("mouseleave", d=>{
        d3.select("#tooltip").style("display","none")
      })
	}
  </script>


  <script type="text/javascript">
    let linechart = d3.select("#linechart1")
    d3.csv("data/somalia.csv").then(showChart)

    function showChart(data){
      
      let bodyHeight = 200
      let bodyWidth = 400

      data = data.map(d => ({
        fecha: +d.ano,
        poblacion: +d.poblacion
      }))

      let maxValue = d3.max(data,d=>+d.poblacion)

      let yScale = d3.scaleLinear()
        .range([bodyHeight,0])
        .domain([0,maxValue]);

      linechart.append("g")
        .call(d3.axisLeft(yScale))
      
      let xScale = d3.scaleLinear()
        .domain(d3.extent(data,d=>d.fecha))
        .range([0,bodyWidth]);

      linechart.append("g")
        .attr("transform","translate(0, "+bodyHeight+")")
        .call(d3.axisBottom(xScale))

      valueline = d3.line()
        .x(d => xScale(d.fecha))
        .y(d => yScale(+d.poblacion))
        .defined(d=> !!+d.poblacion)

      linechart.append("path")
        .datum(data)
        .attr("d",valueline)
        .attr("class","line")
        .attr("fill", "none")
        .attr("stroke", "#619cff")
        .attr("stroke-width", 1.5)
        .attr("stroke-linejoin", "round")
        .attr("stroke-linecap", "round")

      linechart.selectAll("dot")
        .data(data)
        .enter()
        .append("circle")
        .attr("class","dot")
        .attr("fill", "#619cff")
        .attr("stroke", "#619cff")
        .attr("cx", function(d){ return xScale(d.fecha)})
        .attr("cy", function(d){ return yScale(d.poblacion)})
        .attr("r",3.5)
    }
  </script>
  </body>
</html>
